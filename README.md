# Navis 要件定義書（Apple純正版）
バージョン: 1.1  
作成日: 2025-11-08  
作成者: Yukihiro  

---

## 1. 概要

### 1.1 システム名称  
**Navis（ナビス）**

### 1.2 システム概要  
Navis は、沿岸・内湾エリアにおける安全で快適なクルージングを実現する  
**iOSネイティブ航行ナビゲーションアプリ**である。  

GPS、海図、潮汐、気象データを統合し、浅瀬や地域ルールを考慮したルートを案内する。  
UIは **iOS 25 の Apple純正「Material・Depth・Motion」デザイン体系**に基づき、  
透明感と奥行きを備えた “海の上のガラスUI” を実現する。

---

## 2. 開発目的

- プレジャーボート・クルーズ船の **安全航行支援**
- 浅瀬や航行禁止エリアの **回避ナビゲーション**
- 潮流・天候・風向の **リアルタイム可視化**
- 航行ログの自動記録による **航海データの蓄積**
- iPhone単体で完結する **オフラインでも動作する航行ナビ**

---

## 3. 対象環境

| 項目 | 内容 |
|------|------|
| 対応OS | iOS 18 以降（推奨: iOS 25） |
| 対応端末 | iPhone / iPad |
| 開発言語 | Swift |
| UIフレームワーク | SwiftUI（Apple純正Material対応） |
| 地図 | MapKit（カスタム海図タイル対応） |
| データ保存 | CoreData / iCloudKit |
| 通信 | URLSession（REST API） |
| データソース | 気象庁・海上保安庁・OpenSeaMap |
| 配信 | App Store / TestFlight |

---

## 4. 機能要件

### 4.1 航行ナビゲーション
- GPS位置をリアルタイム追跡（CoreLocation）
- 目的地設定（マリーナ名または座標）
- 浅瀬・航行禁止エリアを除外したルート案内
- 進行方向・速度・距離・ETA（推定到着時刻）の表示
- 航行中の状態を **Live Activities / Dynamic Island** に常時表示
- 目的地決定後はフルスクリーンのルートプレビューを表示し、スタート地点（現在地に最も近い港/海岸）〜ゴールまでの全体ラインを確認した上で「スタート」ボタンからナビ開始

### 4.2 浅瀬・危険区域警告
- 海図データ（GeoJSON / ENC）に基づく浅瀬・岩礁可視化
- 接近時に視覚＋音声で警告（バイブレーション対応）
- 航行禁止・速度制限区域をマップ上に明示

### 4.3 気象・潮汐データ統合
- 気象庁 / 海上保安庁のAPIから潮汐・風速・波高を取得
- **Apple純正 `Charts`** で潮位・風速グラフを描画
- リアルタイム更新（1分周期）
- 強風・高潮警報の自動通知

### 4.4 クルーズログ
- 航行経路（GPS座標）を自動記録
- 走行距離・時間・平均速度を算出
- 写真・メモを航行記録に添付
- iCloudKit 同期で端末間共有可能
- 航行履歴をマップ上で再生（タイムライン形式）

### 4.5 緊急サポート
- 海上保安庁（118）へのワンタップ通報
- 現在地と航行情報を含む自動送信テンプレート
- 通報ボタンは大型・高コントラストで常に表示

### 4.6 港湾・地域情報
- マリーナ・給油所・係留場などの位置表示
- 地域別航行ルール（例：別府湾・大阪湾など）を切替可能
- お気に入り港を保存し、出港地候補として利用

---

## 5. 非機能要件

| 区分 | 内容 |
|------|------|
| パフォーマンス | GPS追跡と地図更新を 60fps で滑らかに動作 |
| 安全性 | API通信は TLS 1.3 による暗号化 |
| 可用性 | 通信断時もキャッシュ地図・履歴が参照可能 |
| 拡張性 | 新API・新海域データを容易に追加可能 |
| 電力効率 | Apple純正APIによる省電力モード連携 |
| アクセシビリティ | Dynamic Type / VoiceOver 完全対応 |
| UX統一性 | Human Interface Guidelines (HIG) 準拠 |

---

## 6. デザイン要件（Apple純正 Material・Depth UI）

### 6.1 コンセプト
> 「透明 × 深海 × 光」  
海の静けさと奥行きを、AppleのMaterial Designで表現する。

### 6.2 デザイン要素

| 要素 | 実装 | 役割 |
|------|------|------|
| ガラスパネル | `.background(.ultraThinMaterial)` | 情報カード・設定画面 |
| 浮遊感 | `rotation3DEffect` + `CoreMotion` | デバイス傾きによる立体感 |
| 波のゆらぎ | `phaseAnimator` | 海面の揺れアニメーション |
| 光の反射 | `.overlay` + `.opacity` | 水面のハイライト |
| グラフ | `Charts` | 潮位・風速・波高の視覚化 |
| 状態表示 | `Live Activities` / `WidgetKit` | ロック画面・Dynamic Island用航行情報 |
| フォント | San Francisco Rounded | 優しさと視認性の両立 |
| カラー | DeepSea Blue (#00334E), Aqua Teal (#36C2CF), Silver Mist (#E1E4E8) |

---

## 7. 画面構成

| No | 画面名 | 主な内容 |
|----|--------|----------|
| 1 | 航行マップ（Home） | 現在地、ルート、潮流、風向、ETA表示 |
| 2 | 目的地設定 | マリーナ検索、座標入力、推奨ルート生成 |
| 3 | クルーズログ | 航跡履歴、写真・メモの一覧 |
| 4 | 気象・潮汐情報 | 潮位グラフ・風速可視化（Charts） |
| 5 | 港湾情報 | マリーナ・係留場・地域ルール表示 |
| 6 | 設定・安全 | アラート閾値設定、緊急通報設定 |

---

## 8. 外部データソース / API

| 分類 | 提供元 | データ内容 |
|------|----------|-------------|
| 海図 | 海上保安庁 / OpenSeaMap | 航路・浅瀬・灯標 |
| 潮汐 | 気象庁 | 潮位・潮流情報 |
| 気象 | OpenWeather / 気象庁 | 風速・波高・天候 |
| 港湾情報 | 国土交通省 | マリーナ・港湾設備データ |
| 緊急通報 | 海上保安庁 | 118連携（電話） |

---

## 9. データ構造（概要）

### 航行ログデータ構造

| フィールド | 型 | 説明 |
|-------------|----|------|
| id | UUID | 一意識別子 |
| start_time | Date | 出航時刻 |
| end_time | Date | 帰港時刻 |
| route_points | [Coordinate] | 航跡座標配列 |
| distance | Double | 航行距離（km） |
| avg_speed | Double | 平均速度 |
| notes | String | 航行メモ |
| photos | [URL] | 航行中に撮影した画像 |
| weather_summary | String | 天候概要 |

---

## 10. 保守・運用要件

- 航行データの自動バックアップ（iCloudKit）
- 海図・気象データの定期更新（週次）
- API障害時はキャッシュデータで動作継続
- バージョン管理：GitHub + TestFlight フロー
- Apple HIG / SwiftUIガイドラインに随時追従

---

## 11. 将来的拡張計画

- **Vision Pro 対応**：3D海図と航跡の立体表示  
- **Bluetooth連携**：外部GPS・風速計センサーとの接続  
- **AI航行補助**：潮流・風向から安全経路を自動提案  
- **共有航路クラウド**：他ユーザーのログ共有・レビュー  

---

## 12. デザインキーワード

- “Glass meets Ocean”
- 「深海の透明感 × iOSの洗練」
- Minimal・Calm・Immersive（静と没入のUI）

---

© 2025 Yukihiro / XerographiX
